
{% extends 'issf_base/base.html' %}{% load leaflet_tags %}
{% load staticfiles %}

{% block additional_css_scripts %}
    {% leaflet_css %}
    <link rel="stylesheet" href="{% static "details/css/details.css" %}">
{% endblock additional_css_scripts %}

{% block body %}
{% autoescape off %}
    {% include "issf_base/loading-spinner.html" %}
    <title>{% block title %}ISSF: SSF Governance {% endblock %}</title>

    <section class="content-governance content-section report" id="content-governance">
        <div class="row" id="main">
            <div class="large-12 columns page-title">
                <span>
                    <a
                        href="https://twitter.com?screen_name=TBTInetwork&hashtags=tbtiissf&text=Your Comments!"
                        class="twitter-share-button"
                        data-lang="en"
                        data-size="large"
                    >
                    </a>
                </span>

                <h1>SSF Governance</h1>

                <div class="basic-info">
                    SSF Governance <strong> | </strong>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="large-8 columns">
                <dl class="accordion" data-accordion>
                    <dd class="accordion-navigation active">
                        {% if editor %}
                            <button class="bt-edit">Edit</button>
                        {% endif %}

                        <a class="accordion-nav" href="#panel-basic">Details</a>

                        <div id="panel-basic" class="content">
                            <table>
                                <tr>
                                    <td>
                                        <strong>Case Study Country</strong>
                                    </td>
                                    <td>{{ governance_instance.case_study_country }}</td>
                                </tr>

                                <tr>
                                    <td>
                                        <strong>Contributors Name</strong>
                                    </td>
                                    <td>{{ governance_instance.contributor_names }}</td>
                                </tr>

                                <tr>
                                    <td>
                                        <strong>Contributors Affiliation</strong>
                                    </td>
                                    <td>{{ governance_instance.contributor_affiliations }}</td>
                                </tr>
                            </table>

                            {% if editor %}
                                <form action="{% url 'governance-basic' %}" method="post">
                                    <h6>Please provide details of the existing or needed SSF governance</h6>
                                    <p class="alert"><label>*</label> indicates required fields</p>

                                    {% csrf_token %}
                                    <div class="FormSet" id="governance-basic-form">
                                        <input type="text" name="case_study_country" value="{{ governance_instance.case_study_country }}">
                                    	<input type="text" name="contributor_names" value="{{ governance_instance.contributor_names }}">
                                    	<input type="text" name="contributor_affiliations" value="{{ governance_instance.contributor_affiliations }}">
                                    </div>


                                    <!-- load missing fields from other info div -->
                                    <div class="get-loaded-definition-form-data" style="display: none;"></div>
                                    <div class="get-loaded-institutional-form-data" style="display: none;"></div>
                                    <!-- end loading -->

                                    <input
                                        class="issf_core_id" 
                                        type="hidden"
                                        value="{{ governance_instance.issf_core_id }}"
                                        name="issf_core_id"
                                    >

                                    <div class="button-bar">
                                        <button class="medium radius submit bt-submit">Submit</button>
                                    </div>
                                </form>
                            {% endif %}
                        </div>
                    </dd>


                    <dd class="accordion-navigation">
                        {% if editor %}
                            <button class="bt-edit">Edit</button>
                        {% endif %}
                        <a class="accordion-nav" href="#panel-gc">Geographic Scope</a>

                        <div id="panel-gc" class="content">
                            <table>
                                {% if core_instance.geographic_scope_type == 'Regional' %}
                                    {% for gsregion in geographic_scope_region %}
                                        <tr>
                                            <td>{% ifchanged core_instance.geographic_scope_type %}
                                                <strong>{{ core_instance.geographic_scope_type }}</strong>{% endifchanged %}
                                            </td>
                                            <td>{{ gsregion.region.region_name }}
                                                {% if gsregion.region.region_name == 'Other' %}:
                                                    {{ gsregion.region_name_other }}{% endif %}</td>
                                            <td>{% for gsregioncountry in gsregion.countries.all %}
                                                {{ gsregioncountry.short_name }}, {% endfor %}</td>
                                        </tr>
                                    {% endfor %}
                                {% elif core_instance.geographic_scope_type == 'National' %}
                                    <tr>
                                        <td>
                                            <strong>{{ core_instance.geographic_scope_type }}</strong>
                                        </td>
                                        <td>{% for country in core_instance.countries.all %}
                                            {{ country.short_name }}
                                            , {% endfor %}</td>
                                    </tr>
                                {% elif core_instance.geographic_scope_type == 'Sub-national' %}
                                    {% for gssubnation in geographic_scope_subnation %}
                                        <tr>
                                            <td>{% ifchanged core_instance.geographic_scope_type %}
                                                <strong>{{ core_instance.geographic_scope_type }}</strong>{% endifchanged %}
                                            </td>
                                            <td>{{ gssubnation.subnation_name }}</td>
                                            <td>{% if gssubnation.subnation_type == 'Other' %}
                                                {{ gssubnation.subnation_type_other }}{% else %}
                                                {{ gssubnation.subnation_type }}{% endif %}</td>
                                            <td>{{ gssubnation.country.short_name }}</td>
                                        </tr>
                                    {% endfor %}
                                {% elif core_instance.geographic_scope_type == 'Local' %}
                                    {% for gslocal in geographic_scope_local_area %}
                                        <tr>
                                            <td>{% ifchanged core_instance.geographic_scope_type %}
                                                <strong>{{ core_instance.geographic_scope_type }}</strong>{% endifchanged %}
                                            </td>
                                            <td>{{ gslocal.local_area_name }}
                                                {% if gslocal.local_area_alternate_name|length > 0 %} (
                                                    {{ gslocal.local_area_alternate_name }}){% endif %}</td>
                                            <td>{% if gslocal.local_area_setting == 'Other' %}
                                                {{ gslocal.local_area_setting_other }}{% else %}
                                                {{ gslocal.local_area_setting }}{% endif %}</td>
                                            <td>{{ gslocal.country.short_name }}</td>
                                        </tr>
                                    {% endfor %}
                                {% else %}
                                    <tr>
                                        <td>{{ core_instance.geographic_scope_type }}</td>
                                    </tr>
                                {% endif %}
                            </table>
                            {% if editor %}
                                <div class="multiforms" style="display: none;">
                                    <h6>Please indicate the geographic scope of the profile</h6>

                                    <p class="alert">
                                        <label>*</label>
                                        indicates required fields
                                    </p>

                                    <div class="FormSet FormSetToggler">
                                        {{ geographic_scope_form }}
                                    </div>

                                    <form action="{% url 'geographic-scope' %}" method="post">
                                        {% csrf_token %}
                                        <div class="FormSet FormSetTogglable FormSetGrowable">
                                            {{ local_area_form }}
                                        </div>
                                        <input
                                            id="id_geographic_scope_type_0"
                                            type="hidden"
                                            value="Local"
                                            name="geographic_scope_type"
                                        >
                                        <input
                                            class="issf_core_id"
                                            type="hidden"
                                            value="{{ core_instance.issf_core_id }}"
                                            name="issf_core_id"
                                        >
                                        <div class="FormButtonBar FormButtonBarInitial button-bar">
                                            <button class="medium radius submit bt-submit">Submit</button>
                                        </div>
                                    </form>

                                    <form action="{% url 'geographic-scope' %}" method="post">
                                        {% csrf_token %}
                                        <div class="FormSet FormSetTogglable FormSetGrowable">
                                            {{ subnation_form }}
                                        </div>
                                        <input
                                            id="id_geographic_scope_type_1"
                                            type="hidden"
                                            value="Sub-national"
                                            name="geographic_scope_type"
                                        >
                                        <input
                                            class="issf_core_id"
                                            type="hidden"
                                            value="{{ core_instance.issf_core_id }}"
                                            name="issf_core_id"
                                        >
                                        <div class="FormButtonBar button-bar">
                                            <button class="medium radius submit bt-submit">Submit</button>
                                        </div>
                                    </form>

                                    <form action="{% url 'geographic-scope' %}" method="post">
                                        {% csrf_token %}
                                        <div class="FormSet FormSetTogglable">
                                            {{ nation_form }}
                                        </div>
                                        <input
                                            id="id_geographic_scope_type_2"
                                            type="hidden"
                                            value="National"
                                            name="geographic_scope_type"
                                        >
                                        <input
                                            class="issf_core_id"
                                            type="hidden"
                                            value="{{ core_instance.issf_core_id }}"
                                            name="issf_core_id"
                                        >
                                        <div class="FormButtonBar button-bar">
                                            <button class="medium radius submit bt-submit">Submit</button>
                                        </div>
                                    </form>

                                    <form action="{% url 'geographic-scope' %}" method="post">
                                        {% csrf_token %}
                                        <div class="FormSet FormSetTogglable FormSetGrowable">
                                            {{ region_form }}
                                        </div>
                                        <input
                                            class="issf_core_id"
                                            type="hidden"
                                            value="{{ core_instance.issf_core_id }}"
                                            name="issf_core_id"
                                        >
                                        <div class="FormButtonBar button-bar">
                                            <button class="medium radius submit bt-submit">Submit</button>
                                        </div>
                                    </form>

                                    <form action="{% url 'geographic-scope' %}" method="post" style="display: block">
                                        {% csrf_token %}
                                        <input
                                            id="id_geographic_scope_type_4"
                                            type="hidden"
                                            value="Global"
                                            name="geographic_scope_type"
                                        >
                                        <input
                                            class="issf_core_id"
                                            type="hidden"
                                            value="{{ core_instance.issf_core_id }}"
                                            name="issf_core_id"
                                        >
                                        <div class="FormButtonBar button-bar">
                                            <button class="medium radius submit bt-submit">Submit</button>
                                        </div>
                                    </form>

                                    <form action="{% url 'geographic-scope' %}" method="post" style="display: block">
                                        {% csrf_token %}
                                        <input
                                            class="issf_core_id"
                                            type="hidden"
                                            value="{{ core_instance.issf_core_id }}"
                                            name="issf_core_id"
                                        >
                                        <input
                                            type="hidden"
                                            name="geographic_scope_type"
                                            value="Not specific"
                                            id="id_geographic_scope_type_5"
                                        >
                                        <div class="FormButtonBar button-bar">
                                            <button class="medium radius submit bt-submit">Submit</button>
                                        </div>
                                    </form>
                                </div>
                            {% endif %}
                        </div>
                    </dd>


                    <dd class="accordion-navigation">
                        {% if editor %}
                            <button class="bt-edit">Edit</button>
                        {% endif %}

                        <a class="accordion-nav" href="#panel-definition">Definition of SSF or related terms</a>
                        <div id="panel-definition" class="content">
                            <p>
                                E.G. artisanal, subsistence, semi-industrial, customary, coastal, traditional, indigenous, aboriginal, and tribal. Note that SSF refers mostly to the ‘harvesting/fishing’ activities. Feel free to indicate in Part VI, however, if there are specific definitions related to SSF in post-harvest. 
                            </p>

                            <table>
                                <tr>
                                    <td>
                                        <strong>Are SSF or related terms “legally” defined in the Constitution, Law, or Act?</strong>
                                    </td>
                                    <td>{{ governance_instance.ssf_definition_legal }}</td>
                                    <td>{{ governance_instance.ssf_definition_legal_additional }}</td>
                                </tr>

                                <tr>
                                    <td><strong>Is SSF (or related terms) captured/defined in other legal and policy documents?</strong></td>
                                    <td>{{ governance_instance.ssf_definition_other_policy_type }}</td>
                                    <td>{{ governance_instance.ssf_definition_other_policy_additional }}</td>
                                </tr>

                                <tr>
                                    <td><strong>Is there any other “informal” way that SSF (or related terms) are referred to?</strong></td>
                                    <td>{{ governance_instance.ssf_definition_has_informal_policy }}</td>
                                    <td>{{ governance_instance.ssf_definition_informal_policy_additional }}</td>
                                </tr>
                            </table>

                            {% if editor %}
                                <form action="{% url 'governance-basic' %}" method="post">
                                    {% csrf_token %}
                                    <div class="FormSet" id="governance-definition-form">
                                        <h5 style="margin: 0;">Are SSF or related terms “legally” defined in the Constitution, Law, or Act?:</h5>
                                        <ul>
                                            <li>
                                                <label class="governance-section-label-tick">    
                                                    {% if governance_instance.ssf_definition_legally_defined == "Yes" %}
                                                        <input type="radio" name="ssf_definition_legally_defined" class="boxes-trigger" data-show="true" value="Yes" checked> Yes
                                                    {% else %}
                                                        <input type="radio" name="ssf_definition_legally_defined" class="boxes-trigger" data-show="true" value="Yes"> Yes
                                                    {% endif %}
                                                </label>
                                            </li>

                                            <li>
                                                <label class="governance-section-label-tick">    
                                                    {% if governance_instance.ssf_definition_legally_defined == "No" %}
                                                        <input type="radio" name="ssf_definition_legally_defined" class="boxes-trigger" data-show="false" value="No" checked> No
                                                    {% else %}
                                                        <input type="radio" name="ssf_definition_legally_defined" class="boxes-trigger" data-show="false" value="No"> No
                                                    {% endif %}
                                                </label>
                                            </li>

                                            {% if governance_instance.ssf_definition_legally_defined == "No" %}
                                            <li class="boxes-trigger-true hide">
                                                <label class="governance-section-label">If yes, copy and paste the exact text(s) where SSF or related terms is mentioned:</label>
                                                <textarea rows="5" name="ssf_definition_legal">{{ governance_instance.ssf_definition_legal }}</textarea>
                                            </li>

                                            <li class="boxes-trigger-true hide">
                                                <label class="governance-section-label">Please indicate the exact provision(s) of the Constitution/Law/Act that supports your answer, and provide URL:</label>
                                                <input type="text" name="ssf_definition_legal_additional" value="{{ governance_instance.ssf_definition_legal_additional }}" />
                                            </li>

                                            {% else %}
                                            <li class="boxes-trigger-true">
                                                <label class="governance-section-label">If yes, copy and paste the exact text(s) where SSF or related terms is mentioned:</label>
                                                <textarea rows="5" name="ssf_definition_legal">{{ governance_instance.ssf_definition_legal }}</textarea>
                                            </li>

                                            <li class="boxes-trigger-true">
                                                <label class="governance-section-label">Please indicate the exact provision(s) of the Constitution/Law/Act that supports your answer, and provide URL:</label>
                                                <input type="text" name="ssf_definition_legal_additional" value="{{ governance_instance.ssf_definition_legal_additional }}" />
                                            </li>
                                            {% endif %}
                                        </ul>


                                        <h5>Is SSF (or related terms) captured/defined in other legal and policy documents? <br>
                                            (Select all that apply):</h5>
                                        <ul>
                                            <li>
                                                <label class="governance-section-label-tick">    
                                                    {% if governance_instance.ssf_definition_other_policy_type == "Primary fisheries legislation" %}
                                                        <input type="radio" name="ssf_definition_other_policy_type" class="boxes-trigger" data-show="true" value="Primary fisheries legislation" checked> Primary fisheries legislation
                                                    {% else %}
                                                        <input type="radio" name="ssf_definition_other_policy_type" class="boxes-trigger" data-show="true" value="Primary fisheries legislation"> Primary fisheries legislation
                                                    {% endif %}
                                                </label>
                                            </li>

                                            <li>
                                                <label class="governance-section-label-tick">    
                                                    {% if governance_instance.ssf_definition_other_policy_type == "Regulation, Decree, Ordinance" %}
                                                        <input type="radio" name="ssf_definition_other_policy_type" class="boxes-trigger" data-show="true" value="Regulation, Decree, Ordinance" checked> Regulation, Decree, Ordinance
                                                    {% else %}
                                                        <input type="radio" name="ssf_definition_other_policy_type" class="boxes-trigger" data-show="true" value="Regulation, Decree, Ordinance"> Regulation, Decree, Ordinance
                                                    {% endif %}
                                                </label>
                                            </li>

                                            <li>
                                                <label class="governance-section-label-tick">    
                                                    {% if governance_instance.ssf_definition_other_policy_type == "National fisheries policy" %}
                                                        <input type="radio" name="ssf_definition_other_policy_type" class="boxes-trigger" data-show="true" value="National fisheries policy" checked> National fisheries policy
                                                    {% else %}
                                                        <input type="radio" name="ssf_definition_other_policy_type" class="boxes-trigger" data-show="true" value="National fisheries policy"> National fisheries policy
                                                    {% endif %}
                                                </label>
                                            </li>

                                            <li>
                                                <label class="governance-section-label-tick">    
                                                    {% if governance_instance.ssf_definition_other_policy_type == "No" %}
                                                        <input type="radio" name="ssf_definition_other_policy_type" class="boxes-trigger" data-show="false" value="No" checked> No
                                                    {% else %}
                                                        <input type="radio" name="ssf_definition_other_policy_type" class="boxes-trigger" data-show="false" value="No"> No
                                                    {% endif %}
                                                </label>
                                            </li>

                                            {% if governance_instance.ssf_definition_other_policy_type == "No" %}
                                            <li class="boxes-trigger-true hide">
                                                <label class="governance-section-label">If yes to any of the above, copy and paste the text(s) used to refer to SSF:</label>
                                                <textarea rows="5" name="ssf_definition_other_policy_refer">{{ governance_instance.ssf_definition_other_policy_refer }}</textarea>
                                            </li>

                                            <li class="boxes-trigger-true hide">
                                                <label class="governance-section-label">Please indicate the document that supports your answer:</label>
                                                <input type="text" name="ssf_definition_other_policy_additional" value="{{ governance_instance.ssf_definition_other_policy_additional }}" />
                                            </li>

                                            {% else %}
                                            <li class="boxes-trigger-true">
                                                <label class="governance-section-label">If yes to any of the above, copy and paste the text(s) used to refer to SSF:</label>
                                                <textarea rows="5" name="ssf_definition_other_policy_refer">{{ governance_instance.ssf_definition_other_policy_refer }}</textarea>
                                            </li>

                                            <li class="boxes-trigger-true">
                                                <label class="governance-section-label">Please indicate the document that supports your answer:</label>
                                                <input type="text" name="ssf_definition_other_policy_additional" value="{{ governance_instance.ssf_definition_other_policy_additional }}" />
                                            </li>
                                            {% endif %}
                                        </ul>


                                        <h5>Is there any other “informal” way that SSF (or related terms) are referred to?:</h5>
                                        <ul>
                                            <li>
                                                <label class="governance-section-label-tick">    
                                                    {% if governance_instance.ssf_definition_informal_policy == "Yes" %}
                                                        <input type="radio" name="ssf_definition_informal_policy" class="boxes-trigger" data-show="true" value="Yes" checked> Yes
                                                    {% else %}
                                                        <input type="radio" name="ssf_definition_informal_policy" class="boxes-trigger" data-show="true" value="Yes"> Yes
                                                    {% endif %}
                                                </label>
                                            </li>
                                            
                                            <li>
                                                <label class="governance-section-label-tick">    
                                                    {% if governance_instance.ssf_definition_informal_policy == "No" %}
                                                        <input type="radio" name="ssf_definition_informal_policy" class="boxes-trigger" data-show="false" value="No" checked> No
                                                    {% else %}
                                                        <input type="radio" name="ssf_definition_informal_policy" class="boxes-trigger" data-show="false" value="No"> No
                                                    {% endif %}
                                                </label>
                                            </li>

                                            {% if governance_instance.ssf_definition_informal_policy == "No" %}
                                            <li class="boxes-trigger-true hide">
                                                <label class="governance-section-label">If yes, indicate how:</label>
                                                <textarea rows="5" name="ssf_definition_has_informal_policy">{{ governance_instance.ssf_definition_has_informal_policy }}</textarea>
                                            </li>

                                            <li class="boxes-trigger-true hide">
                                                <label class="governance-section-label">Please indicate the document that supports your answer:</label>
                                                <input type="text" name="ssf_definition_informal_policy_additional" value="{{ governance_instance.ssf_definition_informal_policy_additional }}" />
                                            </li>

                                            {% else %}
                                            <li class="boxes-trigger-true">
                                                <label class="governance-section-label">If yes, indicate how:</label>
                                                <textarea rows="5" name="ssf_definition_has_informal_policy">{{ governance_instance.ssf_definition_has_informal_policy }}</textarea>
                                            </li>

                                            <li class="boxes-trigger-true">
                                                <label class="governance-section-label">Please indicate the document that supports your answer:</label>
                                                <input type="text" name="ssf_definition_informal_policy_additional" value="{{ governance_instance.ssf_definition_informal_policy_additional }}" />
                                            </li>
                                            {% endif %}

                                        </ul>

                                        <!-- load missing fields from other info div -->
                                        <div class="get-loaded-basic-form-data" style="display: none;"></div>
                                        <div class="get-loaded-institutional-form-data" style="display: none;"></div>
                                        <!-- end loading -->
                                        
                                    </div>

                                    <input
                                        class="issf_core_id" 
                                        type="hidden"
                                        value="{{ governance_instance.issf_core_id }}"
                                        name="issf_core_id"
                                    >

                                    <div class="button-bar">
                                        <button class="submit-governance-decoy" type="button" value="Submit">Submit</button>
                                    </div>
                                    <button type="submit" class="hide submit-form"></button>
                                </form>
                            {% endif %}
                        </div>
                    </dd>


                    <dd class="accordion-navigation">
                        {% if editor %}
                            <button class="bt-edit">Edit</button>
                        {% endif %}

                        <a class="accordion-nav" href="#panel-institutional">Legal framework and institutional arrangement</a>
                        <div id="panel-institutional" class="content">
                            <table>
                                <tr>
                                    <td><strong>What is the legal system in the country?</strong></td>
                                    <td>{{ governance_instance.legal_system_law }}</td>
                                    <td>{{ governance_instance.legal_system_law_additional }}</td>
                                </tr>
                            </table>

                            {% if editor %}
                                <form action="{% url 'governance-basic' %}" method="post">
                                    {% csrf_token %}
                                    <div class="FormSet" id="governance-institutional-form">
                                        <h5 style="margin: 0;">What is the legal system in the country?</h5>
                                        <ul>
                                            <li>
                                                <label class="governance-section-label-tick">    
                                                    {% if governance_instance.legal_system_law == "Common Law" %}
                                                        <input type="radio" name="legal_system_law" class="boxes-trigger" data-show="false" value="Common Law" checked> Common Law
                                                    {% else %}
                                                        <input type="radio" name="legal_system_law" class="boxes-trigger" data-show="false" value="Common Law"> Common Law
                                                    {% endif %}
                                                </label>
                                            </li>

                                            <li>
                                                <label class="governance-section-label-tick">    
                                                    {% if governance_instance.legal_system_law == "Civil Law" %}
                                                        <input type="radio" name="legal_system_law" class="boxes-trigger" data-show="false" value="Civil Law" checked> Civil Law
                                                    {% else %}
                                                        <input type="radio" name="legal_system_law" class="boxes-trigger" data-show="false" value="Civil Law"> Civil Law
                                                    {% endif %}
                                                </label>
                                            </li>

                                            <li>
                                                <label class="governance-section-label-tick">    
                                                    {% if governance_instance.legal_system_law == "Customary Law" %}
                                                        <input type="radio" name="legal_system_law" class="boxes-trigger" data-show="false" value="Customary Law" checked> Customary Law
                                                    {% else %}
                                                        <input type="radio" name="legal_system_law" class="boxes-trigger" data-show="false" value="Customary Law"> Customary Law
                                                    {% endif %}
                                                </label>
                                            </li>

                                            <li>
                                                <label class="governance-section-label-tick">    
                                                    {% if governance_instance.legal_system_law == "Mixed Law Systems" %}
                                                        <input type="radio" name="legal_system_law" class="boxes-trigger" data-show="true" value="Mixed Law Systems" checked> Mixed Law Systems
                                                    {% else %}
                                                        <input type="radio" name="legal_system_law" class="boxes-trigger" data-show="true" value="Mixed Law Systems"> Mixed Law Systems
                                                    {% endif %}
                                                </label>
                                            </li>

                                            {% if governance_instance.legal_system_law == "Mixed Law Systems" %}
                                            <li class="boxes-trigger-true">
                                                <label class="governance-section-label">Please Specify:</label>
                                                <input type="text" name="legal_system_law_specific" value=" {{ governance_instance.legal_system_law_specific }}" />
                                            </li>

                                            {% else %}
                                            <li class="boxes-trigger-true hide">
                                                <label class="governance-section-label">Please Specify:</label>
                                                <input type="text" name="legal_system_law_specific" value=" {{ governance_instance.legal_system_law_specific }}" />
                                            </li>
                                            {% endif %}

                                            <li>
                                                <label class="governance-section-label">Please indicate any source (literature, policy, electronic website) where more detailed information can be found:</label>
                                                <textarea rows="5" name="legal_system_law_additional">{{ governance_instance.legal_system_law_additional }}</textarea>
                                            </li>
                                        </ul>

                                        <!-- load missing fields from other info div -->
                                        <div class="get-loaded-basic-form-data" style="display: none;"></div>
                                        <div class="get-loaded-definition-form-data" style="display: none;"></div>
                                        <!-- end loading -->
                                        
                                    </div>

                                    <input
                                        class="issf_core_id" 
                                        type="hidden"
                                        value="{{ governance_instance.issf_core_id }}"
                                        name="issf_core_id"
                                    >

                                    <div class="button-bar">
                                        <button class="submit-governance-decoy" type="button" value="Submit">Submit</button>
                                    </div>
                                    <button type="submit" class="hide submit-form"></button>
                                </form>
                            {% endif %}
                        </div>
                    </dd>
                </dl>
            </div>


            <div class="large-4 columns">
                <div
                    class="fb-comments"
                    data-href="https://issfcloud.toobigtoignore.net{% url 'capacity-details' issf_core_id=core_instance.issf_core_id %}"
                    data-width="220" data-numposts="3" data-colorscheme="light"
                >
                </div>
            </div>

            {% if editor %}
                <a
                    href="#"
                    data-reveal-id="deleteModal"
                    class="button radius"
                    style="background-color: #525252; position: absolute; right:5px; bottom:-10px;"
                >
                    Delete Record
                </a>

                <div
                    id="deleteModal"
                    class="reveal-modal small"
                    data-reveal aria-labelledby="modalTitle"
                    aria-hidden="true"
                    role="dialog"
                >
                    <form class="deleteForm" action="{% url 'delete-record' core_instance.issf_core_id %}">
                        <div class="row">
                            <div class="large-5 columns">
                                <p>WARNING</p>

                                <p>
                                    Are you sure you want to <b style="color:red;">PERMANENTLY</b> delete this record?
                                    <br>
                                    Once deleted, the record content cannot be recovered.
                                </p>

                                <button
                                    class="button radius"
                                    style="background-color: #B70000; margin-right:10px;"
                                    type="submit">DELETE
                                </button>

                                <a
                                    href="#"
                                    class="button radius close-reveal-modal"
                                    style="font-size: 1rem; position: initial; font-weight: normal; line-height: normal; color: white;"
                                >
                                    CANCEL
                                </a>
                            </div>
                        </div>
                    </form>
                    <a class="close-reveal-modal" aria-label="Close">&#215;</a>
                </div>
            {% endif %}
        </div>
    </section>
{% endautoescape %}
{% endblock body %}

{% block additional_js_scripts %}
    {% leaflet_js %}

    <script src="{% static "details/js/map-setup.js" %}" type="text/javascript"></script>
    <script src="{% static "details/js/error-handling.js" %}" type="text/javascript"></script>
    <script src="{% static "details/js/page-functions.js" %}" type="text/javascript"></script>

    <script type="text/javascript">
        // This function serves as a junction between the Leaflet map and
        // The initialization functionality in map_init_basic_ext() can be found in map-setup.js
        function map_init_basic(map, options) {
            var dataurl = '{% url "map-data" %}?issf_core_id={{ core_instance.issf_core_id }}';
            var capacityIcon = L.icon({
                iconUrl: '{% static "img/icon-capacity.png" %}',
                iconSize: [24, 24],
                iconAnchor: [12, 12],
                popupAnchor: [0, 0]
            });

            map_init_basic_ext(map, options, dataurl, capacityIcon);
        }

        // All the map initialization functionality is handled by this function call.
        // The function can be found in map-setup.js
        map_handler();

        // This function handles all form errors; both field- and form-level.
        // It can be found in error-handling.js
        error_handler();




        // Load data of one forms to the others
        $('.get-loaded-basic-form-data').html($('#governance-basic-form').html());
        $('.get-loaded-definition-form-data').html($('#governance-definition-form').html());
        $('.get-loaded-institutional-form-data').html($('#governance-institutional-form').html());




        // Show fields based on checkbox/radio yes/no values
        $('.boxes-trigger').on('click',function(){
            let $this = $(this),
                boxTriggeredTrue = $this.closest('li').siblings('.boxes-trigger-true');
            if($this.data('show') == false){
                boxTriggeredTrue.addClass('hide');
                boxTriggeredTrue.find('input').removeAttr('required');
                boxTriggeredTrue.find('textarea').removeAttr('required');
            }
            else {
                boxTriggeredTrue.removeClass('hide');
                boxTriggeredTrue.find('input').attr('required','required');
                boxTriggeredTrue.find('textarea').attr('required','required');
            }
        });




        // Clear input fields if user selects the no option on the radio/checkbox field
        $('.submit-governance-decoy').on('click',function(){
            $this = $(this);
            $this.closest('dd').find('.boxes-trigger-true').each(function(){
                let boxTriggered = $(this);
                if(boxTriggered.hasClass('hide')){
                    boxTriggered.find('input, textarea').val('');
                }
            });
            $this.parents().siblings('.submit-form').trigger('click');
        });
    </script>
{% endblock additional_js_scripts %}

